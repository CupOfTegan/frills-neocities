{% extends "core/base.njk" %}

{%- block left -%}
{%- endblock -%}

{%- block main -%}
    {% import "_includes/_components/components.njk" as macro with context %}

    <article class="article">
        {{ macro.header(title, description) }}

        <div class="reading-width">
            {%- block mainContent -%}
                {{ content | safe }}
            {%- endblock -%}
        </div>
    </article>

{%- endblock -%}

{%- block right -%}
    {%- block rightContent -%}
        <ul class="unstyled">
            {% if tags.includes("weeknotes") %}
            {% else %}
            <li>Written on <time datetime="{{ page.date | htmlDateString }}">{{ page.date | readableDate }}</time></li>
            {% endif %}
            {% if tags %}
            <li>
                {%- for tag in tags | filterTagList %}
                <span class="tag">#{{ tag }}</span>{%- if not loop.last %} {% endif %}
                {%- endfor %}
            </li>
            {% endif %}
        </ul>

        {% if tags.includes("weeknotes") %}
        <button id="toggleDetail" class="button mb-1" aria-pressed="false">Expand accordions</button>
    {% endif %}
{%- endblock -%}
{%- endblock -%}

{%- block bottom -%}
{%- endblock %}

{% block scriptsContent %}
    {% if tags.includes("weeknotes") %}
    <script>
        const t = document.getElementById('toggleDetail')
        const o = "Expand accordions"
        const c = "Collapse accordions"
        if(t){t.addEventListener("click",function(){document.body.querySelectorAll("details").forEach(e=>{e.hasAttribute("open")?(t.innerHTML=o,t.setAttribute("aria-pressed",!1),e.removeAttribute("open")):(t.innerHTML=c,t.setAttribute("aria-pressed",!0),e.setAttribute("open",!0))})});}</script>
    {% endif %}
{% endblock %}